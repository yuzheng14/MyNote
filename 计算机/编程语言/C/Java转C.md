# Java转C

## 格式化输出

### 数字

| 进制     | 符号 |
| -------- | ---- |
| 八进制   | %o   |
| 十进制   | %d   |
| 十六进制 | %x   |

若要显示各进制数的前缀0、0x和0X，则

| 进制     | 符号     |
| -------- | -------- |
| 八进制   | %#o      |
| 十六进制 | %#x或%#X |

## 转义字符

| 转义序列 | 含义                                   |
| -------- | -------------------------------------- |
| \a       | 警报（ANSI C）                         |
| \b       | 退格                                   |
| \f       | 换页                                   |
| \n       | 换行                                   |
| \r       | 回车                                   |
| \t       | 水平制表符                             |
| \v       | 垂直制表符                             |
| \\\      | 反斜杠（\）                            |
| \\'      | 单引号                                 |
| \\"      | 双引号                                 |
| \\?      | 问号                                   |
| \Ooo     | 八进制值（oo必须是有效的八进制数）     |
| \xhh     | 十六进制数（hh只需是有效的十六进制数） |

## 数据类型

### 类型大小

`sizeof`是C语言的内置运算符，以字节为单位给出指定类型的大小。C99和C11提供`%zd`转换说明匹配`sizeof`的返回类型。

> 一些不支持C99和C11的编译器可用`%u`或`%lu`代替`%zd`。

### 字节

C规定char类型的位数为字节，如char有16位，double为64位，则double为4字节。

## 字符串

C语言中没有专门用于存储字符串的变量类型，字符串都被存储在char类型的数组中。数组由连续的存储单元组成，字符串中的字符被存储在相邻的存储单元中，每个单元存储一个字节。

数组末尾字符为`\0`，这是空字符（null character），C语言用它标记字符串的结束。

`scanf()`在遇到第一个空白（空格、制表符或换行符）时就不再读取输入。一般而言，根据`%s`转换说明，`scanf()`只会读取字符串中的一个单词，而不是一整句。C语言还有其他的输入函数（如`fgets()`），用于读取一般字符串。

<font style="color:pink">C语言如何区分字符串是以一个字节为单位读取还是以多个字节为单位读取？</font>

C中使用`strlen()`来获取字符串的长度



```c
#define DENSITY 62.4
```

预处理器把字符常量定义为62.4

## 常用函数

`sizeof()`用于获取占用的字节数，当运算对象是类型时，必须加圆括号；对于特定量，圆括号可以缺省。但是建议所有情况下都使用圆括号。

```c
char name;
sizeof(char);
sizeof name;
sizeof(name);
```



`strlen()`用于获取字符串的字节数，不算`\0`

## 常量和C预处理器

符号常量是将一个值赋给另一个变量，让这个变量代替一个数值。

### 符号常量的创建方法

方法之一为声明一个变量，然后将该变量设置为所需的常量。

```c
float tax_rate;
tax_rate=0.015;
```

但是`tax_rate`是一个变量，程序可能会无意间改变它的值。C语言还提供了一个更好的方案——C预处理器。如`#include`用于包含其他文件的信息。预处理器也可以用来定义常量。

```c
#define TAX_RATE 0.015
```

编译程序时，程序中所有的`TAX_RATE`都会被替换成`0.015`。这一过程被称为编译时替换（compile_time substitution）。通常，这样定义的常量也被称为明示常量（manifest constant）。

通用格式如下

```c
#define NAME value
```

还有一种方法是使用`const`限定符。`const`使用起来比`#define`更灵活。

### 明示常量

limits.h和float.h头文件中定义了一系列供实现使用的明示常量。如limits.h头文件中包含以下代码

```c
#define INT_MAX +32767
#define INT_MIN -32768          
```

如果在程序中包含`limits.h`头文件，就可以编写下面的代码

```c
printf("Maximum int value on this system = %d\n", INT_MAX);
```



limits.h中的一些明示常量

| 明示常量   | 含义                      |
| ---------- | ------------------------- |
| CHAR_BIT   | char类型的位数            |
| CHAR_MAX   |                           |
| CHAR_MIN   |                           |
| SCHAR_MAX  | signed char类型的最大值   |
| SCHAR_MIN  |                           |
| UCHAR_MAX  | unsigned char类型的最大值 |
| SHRT_MAX   | short类型的最大值         |
| SHRT_MIN   |                           |
| USHRT_MAX  |                           |
| INT_MAX    |                           |
| INT_MIN    |                           |
| UINT_MAX   |                           |
| LONG_MAX   |                           |
| LONG_MIN   |                           |
| ULONG_MAX  |                           |
| LLONG_MAX  |                           |
| LLONG_MIN  |                           |
| ULLONG_MAX |                           |

> 编译器要完全支持C99标准才能识别LLONG_MIN标识符



float.h头文件中定义的一些明示变量

| 明示变量       | 含义                                              |
| -------------- | ------------------------------------------------- |
| FLT_MANT_DIG   | float类型的尾数位数                               |
| FLT_DIG        | float类型的最少有效数字位数（十进制）             |
| FLT_MIN_10_EXP | 带全部有效数字的float类型的最小负指数（以10为底） |
| FLT_MAX_10_EXP | float类型的最大正指数（以10为底）                 |
| FLT_MIN        | 保留全部精度的float类型最小正数                   |
| FLT_MAX        | float类型的最大正数                               |
| FLT_EPSILON    | 1.00和比1.00大的最小float类型值之间的差值         |

把明示常量名中的`FLT`分别替换成`DBL`和`LDBL`，即可分别表示double和long double类型对应的明示变量

> 表中假设系统使用2的幂来表示浮点数

## 关键字

### const

C90标准新增了`const`关键字，用于限定一个变量为只读。

## I/O

### printf()

请求`printf()`函数打印数据的指令要与待打印数据的类型相匹配。例如打印正数时使用%d。这些符号呗成为**转换说明**（conversion specification），它们指定了如何把数据转换成可显示的形式。



转换说明及其打印的输出结果

| 转换说明 | 输出                                                         |
| -------- | ------------------------------------------------------------ |
| %a       | 浮点数、十六进制数和p记数法（C99/C11）                       |
| %A       | 浮点数、十六进制数和p记数法（C99/C11）                       |
| %c       | 单个字符                                                     |
| %d       | 有符号十进制整数                                             |
| %e       | 浮点数，e记数法                                              |
| %E       | 同%e                                                         |
| %f       | 浮点数，十进制记数法                                         |
| %g       | 根据值的不同，自动选择%f或%e，%e格式用于指数小于-4或者大于或等于精度时 |
| %G       | 同%g                                                         |
| %i       | 有符号十进制整数（同%d）                                     |
| %o       | 无符号八进制整数                                             |
| %p       | 指针                                                         |
| %s       | 字符串                                                       |
| %u       | 无符号十进制整数                                             |
| %x       | 无符号十六进制整数，使用十六进制数0f                         |
| %X       | 无符号十六进制整数，使用十六进制数0F                         |
| %%       | 打印一个百分号                                               |



`printf()`函数的格式：

```c
printf( 格式化字符串，待打印项1，待打印项2，...);
```



在%和转换字符之间插入修饰符可修饰基本的转换说明。

| 修饰符 | 含义                                                         |
| ------ | ------------------------------------------------------------ |
| 标记   | 标记总共有5种，可以不使用或使用多个标记，详见标记表          |
| 数字   | 最小字段宽度</br>如果该字段不能容纳待打印的数字或字符串，系统会使用更宽的字段 |
| .数字  | 精度<br>对于%e、%E和%f转换，表示小数点右边数字的位数<br>对于%g和%G转换，表示有效数字最大位数<br>对于%s转换，表示待打印字符的最大数量<font style="color: pink">字符还是字节？</font><br>对于整型转换，表示待打印数字的最小位数<br>如有必要，使用前导0来达到这个位数<br>只使用.表示其后跟随一个0，所以%.f和5.0f相同 |
| h      | 和整型转换说明一起使用，表示short int 或unsigned short int类型的值<br>示例："%hu" "%hx" "%6.4hd" |
| hh     | 和整型转换说明一起使用，表示 signed char 或 unsigned char 类型的值<br>示例："%hhu" "%hhx" "%6.4hhd" |
| j      | 和整型转换说明一起使用表示 intmax_t 或 uintmax_t 类型的值。这些类型定义在 `stdint.h`文件中<br>示例："%jd" "%8jx" |
| l      | 和整型转换说明一起使用，表示 long int 或 unsigned long int 类型的值<br>示例："%ld" "%8lu" |
| ll     | 和整型转换说明一起使用，表示 long long int 或 unsigned long long int 类型的值（C99） |
| L      | 和浮点转换说明一起使用，表示long double类型的值<br>示例："%Ld" "%10.4Le" |
| t      | 和整型转换说明一起使用，表示 `ptrdiff_t` 类型的值。 `ptrdiff_t` 是两个指针差值的类型（C99）<br>示例："%td" "%12ti" |
| z      | 和整型转换说明一起使用，表示 `size_t` 类型的值。 `size_t` 是 `sizeof` 返回的类型（C99）<br>示例："%zd" "%12zd" |

| 标记 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| -    | 待打印项左对齐。即从字段的左侧开始打印改项<br>示例："%-20s"  |
| +    | 有符号值若为正，则在值前面显示加号；若为负，则在值前面显示减号<br>eg: %+6.2f |
| 空格 | 有符号值若为正，则在值前面显示前导空格（不显示任何符号）；若为负，则在值前面显示减号<br>+标记覆盖一个空格<br><font style="color:blue">经测试，为正时值前面什么都不显示</font><br>eg： % 6.2f |
| #    |                                                              |
| 0    |                                                              |

